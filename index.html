<!DOCTYPE html>
<html lang="ru">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-orientations" content="portrait">
  <meta name="theme-color" content="#007a40">
  <meta name="screen-orientation" content="portrait">

  <link rel="apple-touch-icon" sizes="180x180" href="img/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="img/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="img/favicon-16x16.png">
  <link rel="manifest" href="site.webmanifest">

  <title>–î–µ–≤–∏–∑ –¥–Ω—è</title>

  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 20px;
      color: #333;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #007a40;
      background-image: url(img/fonnew.png);
      background-position: center;
      background-repeat: no-repeat;
      background-size: cover;
      overflow: hidden;

      -webkit-text-size-adjust: 100%;
      -ms-text-size-adjust: 100%;
      text-size-adjust: 100%;
    }

    .clouds {
      position: absolute;
      width: 100%;
      height: 100vh;
    }

    .cloud {
      position: absolute;
      width: 200px;
      z-index: 5;
      animation-timing-function: linear;
      animation-iteration-count: infinite;
      filter: blur(2px);
    }

    /* –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–∞—è –∞–Ω–∏–º–∞—Ü–∏—è –¥–≤–∏–∂–µ–Ω–∏—è –æ–±–ª–∞–∫–æ–≤ */
    @keyframes cloudMove {
      0% {
        transform: translateX(-100%);
      }

      100% {
        transform: translateX(100vw);
      }
    }

    /* –†–∞–∑–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –æ–±–ª–∞–∫–∞ */

    .cloud:nth-child(1) {
      width: 250px;
      top: 2%;
      animation-name: cloudMove;
      animation-duration: 170s;
      animation-delay: -125s;
    }

    .cloud:nth-child(2) {
      width: 240px;
      top: 12%;
      animation-name: cloudMove;
      animation-duration: 160s;
      animation-delay: -40s;
    }

    .cloud:nth-child(3) {
      top: 30%;
      animation-name: cloudMove;
      animation-duration: 125s;
      animation-delay: -100s;
    }

    .cloud:nth-child(4) {
      top: 33%;
      animation-name: cloudMove;
      animation-duration: 140s;
      animation-delay: -40s;

    }

    .cloud:nth-child(5) {
      bottom: 34%;
      animation-name: cloudMove;
      animation-duration: 135s;
      animation-delay: -120s;
    }

    .cloud:nth-child(6) {
      width: 250px;
      bottom: 27%;
      animation-name: cloudMove;
      animation-duration: 70s;
      animation-delay: -15s;
    }


    .logo {
      position: relative;
      width: 500px;
      z-index: 70;
      transition: top 0.5s ease-in-out;
    }

    .logo.up {
      top: -20px !important;
    }

    .content-wrapper {
      position: relative;
      display: flex;
      align-items: flex-end;
      max-width: 900px;
      top: -60px;
      flex-direction: column;
      align-items: center;
      z-index: 10;
    }

    .randomizer-container {
      position: relative;
      flex-grow: 1;
      display: flex;
      text-align: center;
      align-items: flex-end;
      justify-content: center;
      max-width: 500px;
      width: 340px;
      width: auto;
      height: 660px;
      padding: 30px;
    }

    .phrases-container {
      position: absolute;
      height: 400px;
      overflow: hidden;
      z-index: 10;
      width: 100%;
      top: 0px;
      -webkit-mask: linear-gradient(to bottom,
          transparent 3%,
          white 15%,
          white 90%,
          transparent 100%);
      mask: linear-gradient(to bottom,
          transparent 3%,
          white 15%,
          white 90%,
          transparent 100%);
      transition: transform 0.5s ease-out;
    }

    .phrases-container.spinning {
      transform: scale(1.26);
    }

    .phrases-list {
      position: relative;
      transition: transform 0.1s linear;
    }

    .phrase {
      height: 130px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.5s ease-out;
      padding: 0;
      text-align: center;
      position: relative;
    }

    .phrase-image {
      max-height: 100%;
      object-fit: contain;
      transition: all 0.3s ease;
      filter: blur(0);
      transition: all 0.5s ease-out;
    }

    .phrase:not(.active) .phrase-image {
      width: 70%;
    }

    .phrase.active .phrase-image {
      width: 100%;
      opacity: 1;
      filter: blur(0);
      transform: scale(1.7);
      transition: all 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    }

    .phrase.center-highlight .phrase-image {
      width: 100%;
      transform: scale(1.5);
      opacity: 1;
      filter: blur(0);
      transition: all 1.4s ease;
    }

    .phrase.top-fade {
      opacity: 1;
    }

    .phrase.bottom-fade {
      opacity: 1;
      -webkit-mask: linear-gradient(to bottom, white 20%, transparent 90%);
      mask: linear-gradient(to bottom, white 20%, transparent 90%);
    }

    .controls {
      position: relative;
      display: flex;
      justify-content: flex-end;
      align-items: center;
      flex-direction: column;
      gap: 15px;
      margin-top: 20px;
      color: white;
      background-size: contain;
      background-position: bottom;
      background-repeat: no-repeat;
      width: 100vw;
      height: 100%;
      max-height: 300px;
      z-index: 50;
    }

    button {
      padding: 12px 25px;
      border: none;
      border-radius: 50px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(0, 106, 55, 0.2);
      position: relative;
      overflow: hidden;
    }

    #spinButton {
      padding: 0;
      width: 100%;
      height: 80px;
      bottom: -70px;
      background: linear-gradient(135deg, #00A86B, #006A37);
      background-image: url(img/knopka.png);
      color: white;
      background-size: cover;
      background-position: center;
      background-position-y: 0;
      background-repeat: no-repeat;
      box-shadow: unset;
      z-index: 60;
      transition: all 0.1s ease;
      border: none;
      outline: none;
    }

    #spinButton:active {
      background-image: url(img/knopkaact.png);
    }

    #spinButton.spinning {
      background-image: url(img/knopkaact.png);
    }

    #spinButton:disabled {
      cursor: not-allowed;
      transform: none !important;
    }

    #stopButton {
      display: none;
      background: linear-gradient(135deg, #ff6b6b, #c44545);
      color: white;
    }

    #stopButton:hover {
      background: linear-gradient(135deg, #ff7b7b, #d45555);
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(196, 69, 69, 0.4);
    }

    #stopButton:disabled {
      background: linear-gradient(135deg, #cccccc, #aaaaaa);
      cursor: not-allowed;
      transform: none;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
    }

    .status {
      display: none;
      margin-top: 15px;
      font-size: 14px;
      color: #006A37;
      height: 20px;
      font-weight: 500;
    }

    .foxs {
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .fox {
      position: absolute;
      width: 322px;
      transition: all 0.5s ease-in-out;
    }

    .fox:nth-child(1) {
      z-index: 30;
      top: 87px;
    }

    .fox.desc,
    .fox.mob {
      width: 181px;
      top: 20px;
      z-index: 40;
    }

    .fox:nth-child(4) {
      z-index: 50;
      top: 87px;
    }

    .fox-down .fox.desc,
    .fox-down .fox.mob {
      top: 110px;
    }

    .mob {
      display: none;
    }


    @media (max-width: 900px) and (orientation: landscape) {
      body {
        transform: rotate(90deg);
        width: 100vw;
        height: 100vh;
        overflow: hidden;
      }

      .logo {
        width: 60%;
      }

      #spinButton {
        width: 90%;
        height: 70px;
        bottom: -60px;
        left: 3px;
      }

      .fox-down .fox.desc,
      .fox-down .fox.mob {
        top: 110px;
      }
    }

    @media (max-width: 550px) {

      html,
      body {
        height: 100%;
        margin: 0;
        padding: 0;
        overflow: hidden;
      }

      body {
        position: fixed;
        min-height: 100%;
        overflow: hidden;
        background-image: url(img/bgm.png);
      }

      .clouds {
        overflow: hidden;
      }

      .phrases-container {
        width: 340px;
        height: 390px;
        top: 55px;
      }

      .mob {
        display: flex;
      }

      .desc {
        display: none;
      }

      .logo {
        top: 100px;
        width: 260px;
      }

      .randomizer-container {
        height: 700px;
        width: 100vw;
      }

      button {
        width: 100%;
      }

      #spinButton {
        height: 66px;
        bottom: -57px;
      }

      .fox-down .fox.desc,
      .fox-down .fox.mob {
        top: 80px;
      }
    }

    .phrases-container.spinning .phrase.top-fade,
    .phrases-container.spinning .phrase.bottom-fade {
      -webkit-mask: none;
      mask: none;
    }
  </style>

  <style>
    .preloader {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: #007a40;
      background-image: url(img/fonnew.png);
      background-position: center;
      background-repeat: no-repeat;
      background-size: cover;
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 9999;
      transition: opacity 0.5s ease;
    }

    .preloader.hidden {
      opacity: 0;
      visibility: hidden;
    }

    .preloader-content {
      text-align: center;
      color: white;
    }

    .preloader-logo {
      margin-bottom: 30px;
    }

    .preloader-logo img {
      width: 200px;
      height: auto;
    }

    .progress-container {
      width: 300px;
      margin: 0 auto 20px;
    }

    .progress-bar {
      width: 100%;
      height: 6px;
      background: rgba(255, 255, 255, 0.3);
      border-radius: 3px;
      overflow: hidden;
      margin-bottom: 10px;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #00A86B, #ffffff);
      border-radius: 3px;
      width: 0%;
      transition: width 0.1s linear !important;
      /* –ë—ã—Å—Ç—Ä–∞—è –∞–Ω–∏–º–∞—Ü–∏—è */
    }

    .progress-text {
      font-size: 14px;
      font-weight: 600;
      color: white;
    }

    .loading-text {
      font-size: 16px;
      color: white;
      opacity: 0.8;
      animation: pulse 1.5s infinite;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #00A86B, #ffffff);
      border-radius: 3px;
      width: 0%;
      transition: width 0.5s ease-in-out;
      transform-origin: left;
    }

    @keyframes pulse {

      0%,
      100% {
        opacity: 0.8;
      }

      50% {
        opacity: 1;
      }
    }
  </style>
</head>

<body>


  <!-- –ü–æ–º–µ—Å—Ç–∏ —ç—Ç–æ –ü–ï–†–í–´–ú —ç–ª–µ–º–µ–Ω—Ç–æ–º –≤ body -->
  <div id="preloader" class="preloader">
    <div class="preloader-content">
      <div class="preloader-logo">
        <img src="img/logonew.svg" alt="–î–µ–≤–∏–∑ –¥–Ω—è">
      </div>
      <div class="progress-container">
        <div class="progress-bar">
          <div class="progress-fill" id="progressFill"></div>
        </div>
        <div class="progress-text" id="progressText">0%</div>
      </div>
      <div class="loading-text">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
    </div>
  </div>

  <div class="clouds">
    <img class="cloud" src="img/cloud1.svg" alt="">
    <img class="cloud" src="img/cloud2.svg" alt="">
    <img class="cloud" src="img/cloud3.svg" alt="">
    <img class="cloud" src="img/cloud4.svg" alt="">
    <img class="cloud" src="img/cloud5.svg" alt="">
    <img class="cloud" src="img/cloud1.svg" alt="">
  </div>

  <div class="content-wrapper">
    <img class="logo" src="img/logonew.svg" alt="">
    <div class="randomizer-container">
      <div class="phrases-container">
        <div class="phrases-list" id="phrasesList"></div>
      </div>

      <div class="controls">
        <div class="foxs " id="foxsContainer">
          <img class="fox" src="img/korz3.png" alt="">
          <img class="fox mob" src="vid/1.gif" alt="">
          <video class="fox desc" src="vid/1.webm" autoplay loop muted playsinline autoPlay={true}></video>
          <img class="fox" src="img/korz1.png" alt="">
        </div>

        <button id="spinButton"></button>
        <button id="stopButton" disabled>–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å</button>
      </div>
      <div class="status" id="status"></div>
    </div>
  </div>

  <script>
    // –ü—Ä–µ–ª–æ–∞–¥–µ—Ä —Å –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ–º –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
    console.log('üîß –ó–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —Å–∫—Ä–∏–ø—Ç –ø—Ä–µ–ª–æ–∞–¥–µ—Ä–∞...');

    let preloaderStarted = false;
    let criticalImagesLoaded = false;

    function simplePreloader() {
      if (preloaderStarted) return;
      preloaderStarted = true;

      console.log('üéØ –ó–∞–ø—É—Å–∫ –ø—Ä–µ–ª–æ–∞–¥–µ—Ä–∞ —Å –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π');

      const preloader = document.getElementById('preloader');
      if (!preloader) {
        console.error('‚ùå –ü—Ä–µ–ª–æ–∞–¥–µ—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω');
        startMainApplication();
        return;
      }

      console.log('‚úÖ –ü—Ä–µ–ª–æ–∞–¥–µ—Ä –Ω–∞–π–¥–µ–Ω');

      // –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è
      const criticalImages = [
        'img/korz3.png',
        'img/korz1.png',
        'img/avangard.png',
        'img/logonew.svg'
      ];

      // –ù–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö –¥–æ–±–∞–≤–ª—è–µ–º –≥–∏—Ñ–∫—É, –Ω–∞ –¥–µ—Å–∫—Ç–æ–ø - –≤–∏–¥–µ–æ
      if (window.innerWidth <= 550) {
        criticalImages.push('vid/1.gif');
        console.log('üì± –ú–æ–±–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è - –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º –≥–∏—Ñ–∫—É');
      } else {
        criticalImages.push('vid/1.webm');
        console.log('üíª –î–µ—Å–∫—Ç–æ–ø –≤–µ—Ä—Å–∏—è - –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º –≤–∏–¥–µ–æ');
      }

      let loadedImages = 0;
      const totalCriticalImages = criticalImages.length;

      console.log(`üì¶ –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º ${totalCriticalImages} –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π:`, criticalImages);

      // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –æ–¥–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
      function trackImageLoad(imageUrl) {
        return new Promise((resolve) => {
          const img = new Image();
          img.onload = () => {
            loadedImages++;
            console.log(`‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ: ${imageUrl} (${loadedImages}/${totalCriticalImages})`);
            resolve();
          };
          img.onerror = () => {
            loadedImages++;
            console.warn(`‚ö†Ô∏è –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: ${imageUrl} (${loadedImages}/${totalCriticalImages})`);
            resolve(); // –í—Å–µ —Ä–∞–≤–Ω–æ —Å—á–∏—Ç–∞–µ–º –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–º
          };
          img.src = imageUrl;
        });
      }

      let progress = 0;
      const startTime = Date.now();
      const minDuration = 500; // –ú–∏–Ω–∏–º—É–º 0,5 —Å–µ–∫—É–Ω–¥–∞

      function updateProgress() {
        const elapsed = Date.now() - startTime;

        // –ü—Ä–æ–≥—Ä–µ—Å—Å –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤—Ä–µ–º–µ–Ω–∏ (–º–∞–∫—Å–∏–º—É–º 70%)
        const timeProgress = Math.min((elapsed / minDuration) * 70, 70);

        // –ü—Ä–æ–≥—Ä–µ—Å—Å –Ω–∞ –æ—Å–Ω–æ–≤–µ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (–º–∞–∫—Å–∏–º—É–º 30%)
        const imageProgress = (loadedImages / totalCriticalImages) * 30;

        // –û–±—â–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å
        const totalProgress = Math.min(timeProgress + imageProgress, 100);

        // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä
        const progressFill = document.getElementById('progressFill');
        const progressText = document.getElementById('progressText');

        if (progressFill) progressFill.style.width = totalProgress + '%';
        if (progressText) progressText.textContent = Math.round(totalProgress) + '%';

        console.log(`üìä –ü—Ä–æ–≥—Ä–µ—Å—Å: ${Math.round(totalProgress)}% (–≤—Ä–µ–º—è: ${Math.round(timeProgress)}%, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è: ${Math.round(imageProgress)}%)`);

        // –£—Å–ª–æ–≤–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:
        // 1. –ü—Ä–æ—à–ª–æ –º–∏–Ω–∏–º—É–º –≤—Ä–µ–º–µ–Ω–∏ –ò –≤—Å–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∑–∞–≥—Ä—É–∂–µ–Ω—ã
        // 2. –ò–ª–∏ –ø—Ä–æ—à–ª–æ –±–æ–ª—å—à–µ 4 —Å–µ–∫—É–Ω–¥ (—Ñ–æ–ª–±—ç–∫)
        const imagesComplete = loadedImages >= totalCriticalImages;
        const timeComplete = elapsed >= minDuration;
        const fallbackComplete = elapsed >= 8000;

        const shouldComplete = (timeComplete && imagesComplete) || fallbackComplete;

        if (!shouldComplete) {
          requestAnimationFrame(updateProgress);
        } else {
          console.log('üéâ –ó–∞–≤–µ—Ä—à–∞–µ–º –ø—Ä–µ–ª–æ–∞–¥–µ—Ä');
          criticalImagesLoaded = true;
          completePreloader();
        }
      }

      function completePreloader() {
        // –£–±–µ–∂–¥–∞–µ–º—Å—è —á—Ç–æ –ø—Ä–æ–≥—Ä–µ—Å—Å 100%
        const progressFill = document.getElementById('progressFill');
        const progressText = document.getElementById('progressText');
        if (progressFill) progressFill.style.width = '100%';
        if (progressText) progressText.textContent = '100%';

        // –ü–ª–∞–≤–Ω–æ —Å–∫—Ä—ã–≤–∞–µ–º
        preloader.style.transition = 'opacity 0.5s ease';
        preloader.style.opacity = '0';

        setTimeout(() => {
          preloader.style.display = 'none';
          console.log('‚úÖ –ü—Ä–µ–ª–æ–∞–¥–µ—Ä —Å–∫—Ä—ã—Ç, –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∑–∞–≥—Ä—É–∂–µ–Ω—ã:', criticalImagesLoaded);
          startMainApplication();
        }, 500);
      }

      // –ó–∞–ø—É—Å–∫–∞–µ–º –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
      Promise.all(criticalImages.map(trackImageLoad))
        .then(() => {
          console.log('üéØ –í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∑–∞–≥—Ä—É–∂–µ–Ω—ã!');
          criticalImagesLoaded = true;
        })
        .catch(error => {
          console.error('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π:', error);
        });

      // –ó–∞–ø—É—Å–∫–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
      updateProgress();
    }

    function startMainApplication() {
      console.log('üöÄ –ó–∞–ø—É—Å–∫ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è...');

      try {
        if (window.appInitialized) {
          console.log('‚è≠Ô∏è –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —É–∂–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–æ');
          return;
        }
        window.appInitialized = true;

        // –ó–ê–ü–£–°–ö–ê–ï–ú –¢–û–õ–¨–ö–û –û–°–ù–û–í–ù–´–ï –§–£–ù–ö–¶–ò–ò
        shufflePhrasesOnInit();
        renderPhrases();
        setupEventListeners();
        setupInitialState();
        startCloudsAnimation();

        // –ó–ê–ü–£–°–ö–ê–ï–ú –ê–í–¢–û–ü–†–û–ö–†–£–¢–ö–£ –ß–ï–†–ï–ó 6 –°–ï–ö–£–ù–î –ü–û–°–õ–ï –ü–†–ï–õ–û–£–î–ï–†–ê
        setTimeout(() => {
          console.log('‚è∞ 6 —Å–µ–∫—É–Ω–¥ –ø–æ—Å–ª–µ –ø—Ä–µ–ª–æ–∞–¥–µ—Ä–∞ - –∑–∞–ø—É—Å–∫–∞–µ–º –∞–≤—Ç–æ–ø—Ä–æ–∫—Ä—É—Ç–∫—É');
          // –ù–ï –£–ë–ò–†–ê–ï–ú –ê–ö–¢–ò–í–ù–û–°–¢–¨ –° "–ê–í–ê–ù–ì–ê–†–î–ï" - –æ–Ω–∞ —Å–∞–º–∞ —É–π–¥–µ—Ç –ø—Ä–∏ –∞–≤—Ç–æ–ø—Ä–æ–∫—Ä—É—Ç–∫–µ
          startAutoScroll();
        }, 3000);

        console.log('‚úÖ –û—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–æ, –∞–≤—Ç–æ–ø—Ä–æ–∫—Ä—É—Ç–∫–∞ —á–µ—Ä–µ–∑ 6 —Å–µ–∫');
      } catch (error) {
        console.error('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:', error);
      }
    }

    // –°–¢–†–ê–¢–ï–ì–ò–Ø –ó–ê–ü–£–°–ö–ê
    if (/Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {
      console.log('üì± –ú–æ–±–∏–ª—å–Ω–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ - –∑–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–µ–ª–æ–∞–¥–µ—Ä —Å—Ä–∞–∑—É');
      setTimeout(simplePreloader, 100);
    } else {
      console.log('üíª –î–µ—Å–∫—Ç–æ–ø - –∂–¥–µ–º DOMContentLoaded');
      document.addEventListener('DOMContentLoaded', simplePreloader);
    }

    // –£–ë–ò–†–ê–ï–ú –õ–ò–®–ù–ò–ô –ö–û–î –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–ò - –æ—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ —ç—Ç–æ:
    document.addEventListener('DOMContentLoaded', function () {
      console.log('üìÑ DOM –∑–∞–≥—Ä—É–∂–µ–Ω');
      lockOrientation();

      // –ï–°–õ–ò –ü–†–ï–õ–û–ê–î–ï–† –ù–ï –°–†–ê–ë–û–¢–ê–õ –ß–ï–†–ï–ó 10 –°–ï–ö–£–ù–î - –ó–ê–ü–£–°–ö–ê–ï–ú –†–ï–ó–ï–†–í–ù–£–Æ –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Æ
      setTimeout(() => {
        if (!window.appInitialized) {
          console.warn('üîÑ –†–µ–∑–µ—Ä–≤–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è (–ø—Ä–µ–ª–æ–∞–¥–µ—Ä –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª)');
          startMainApplication();
        }
      }, 10000);
    });


    // –§–æ–ª–±—ç–∫
    setTimeout(() => {
      if (!preloaderStarted) {
        console.warn('‚è∞ –§–æ–ª–±—ç–∫: –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ –ø—Ä–µ–ª–æ–∞–¥–µ—Ä–∞');
        simplePreloader();
      }
    }, 1000);

    console.log('üèÅ –°–∫—Ä–∏–ø—Ç –ø—Ä–µ–ª–æ–∞–¥–µ—Ä–∞ –∑–∞–≥—Ä—É–∂–µ–Ω');
  </script>

  <script>
    // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏
    const PHRASES = [
      {
        text: "–ù—É–∂–Ω–∞ –ª–∏ —Ä–µ–∫–ª–∞–º–∞ —Å–æ–≤–µ—Ä—à–µ–Ω—Å—Ç–≤—É?",
        image: "img/bmw.png",
        alt: "–ù—É–∂–Ω–∞ –ª–∏ —Ä–µ–∫–ª–∞–º–∞ —Å–æ–≤–µ—Ä—à–µ–Ω—Å—Ç–≤—É?"
      },
      {
        text: "–í—Ä–µ–º—è –±—ã—Ç—å –≤ –ê–≤–∞–Ω–≥–∞—Ä–¥–µ ",
        image: "img/avangard.png",
        alt: "–í—Ä–µ–º—è –±—ã—Ç—å –≤ –ê–≤–∞–Ω–≥–∞—Ä–¥–µ"
      },
      {
        text: "–ñ–∏–≤–∏ –Ω–∞ —è—Ä–∫–æ–π —Å—Ç–æ—Ä–æ–Ω–µ.",
        image: "img/beeline.png",
        alt: "–ñ–∏–≤–∏ –Ω–∞ —è—Ä–∫–æ–π —Å—Ç–æ—Ä–æ–Ω–µ."
      },
      {
        text: "–ë—É–¥—É—â–µ–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç–µ–±—è.",
        image: "img/megafon.png",
        alt: "–ë—É–¥—É—â–µ–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç–µ–±—è."
      },
      {
        text: "–ë–µ—Ä–∏ –æ—Ç –∂–∏–∑–Ω–∏ –≤—Å–µ",
        image: "img/pepsi.png",
        alt: "–ë–µ—Ä–∏ –æ—Ç –∂–∏–∑–Ω–∏ –≤—Å–µ"
      },
      {
        text: "–ù–µ—Ç –Ω–∏—á–µ–≥–æ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ–≥–æ",
        image: "img/adidas.png",
        alt: "–ù–µ—Ç –Ω–∏—á–µ–≥–æ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ–≥–æ"
      },
      {
        text: "–ü—Ä–∞–∑–¥–Ω–∏–∫ –∫ –Ω–∞–º –ø—Ä–∏—Ö–æ–¥–∏—Ç",
        image: "img/cola.png",
        alt: "–ü—Ä–∞–∑–¥–Ω–∏–∫ –∫ –Ω–∞–º –ø—Ä–∏—Ö–æ–¥–∏—Ç"
      },
      {
        text: "–ù–µ –≥—Ä—É—Å—Ç–∏ ‚Äî –ø–æ—Ö—Ä—É—Å—Ç–∏",
        image: "img/3kor.png",
        alt: "–ù–µ –≥—Ä—É—Å—Ç–∏ ‚Äî –ø–æ—Ö—Ä—É—Å—Ç–∏"
      },
      {
        text: "–ò –ø—É—Å—Ç—å –≤–µ—Å—å –º–∏—Ä –ø–æ–¥–æ–∂–¥–µ—Ç",
        image: "img/danissimo.png",
        alt: "–ò –ø—É—Å—Ç—å –≤–µ—Å—å –º–∏—Ä –ø–æ–¥–æ–∂–¥–µ—Ç"
      },
      {
        text: "–í—Å–µ –≤ –≤–æ—Å—Ç–æ—Ä–≥–µ –æ—Ç —Ç–µ–±—è",
        image: "img/maybelline.png",
        alt: "–í—Å–µ –≤ –≤–æ—Å—Ç–æ—Ä–≥–µ –æ—Ç —Ç–µ–±—è"
      },
      {
        text: "–í—Å—ë –±—É–¥–µ—Ç, –≤ —à–æ–∫–æ–ª–∞–¥–µ",
        image: "img/mars.png",
        alt: "–í—Å—ë –±—É–¥–µ—Ç, –≤ —à–æ–∫–æ–ª–∞–¥–µ"
      },
      {
        text: "–í–ª–∏–≤–∞–π—Å—è",
        image: "img/fanta.png",
        alt: "–í–ª–∏–≤–∞–π—Å—è"
      },
      {
        text: "–£–∑–Ω–∞–π, –Ω–∞ —á—Ç–æ —Ç—ã —Å–ø–æ—Å–æ–±–µ–Ω ",
        image: "img/burn.png",
        alt: "–£–∑–Ω–∞–π, –Ω–∞ —á—Ç–æ —Ç—ã —Å–ø–æ—Å–æ–±–µ–Ω"
      },
      {
        text: "–ö–ª–∏–Ω—Å–∫–æ–µ",
        image: "img/klinskoe.png",
        alt: "–ö–ª–∏–Ω—Å–∫–æ–µ"
      },
      {
        text: "–¢—ã –≤—Å–µ–≥–¥–∞ –¥—É–º–∞–µ—à—å –æ –Ω–∞—Å ",
        image: "img/tefal.png",
        alt: "–¢—ã –≤—Å–µ–≥–¥–∞ –¥—É–º–∞–µ—à—å –æ –Ω–∞—Å"
      },
      {
        text: "kodak",
        image: "img/kodak.png",
        alt: "kodak"
      },
      {
        text: "–ù–∞–¥–æ —á–∞—â–µ –≤—Å—Ç—Ä–µ—á–∞—Ç—å—Å—è",
        image: "img/danone.png",
        alt: "–ù–∞–¥–æ —á–∞—â–µ –≤—Å—Ç—Ä–µ—á–∞—Ç—å—Å—è"
      },
      {
        text: "levis",
        image: "img/levis.png",
        alt: "levis"
      },
      {
        text: "–°—Ç—Ä–µ–º–ª–µ–Ω–∏–µ –∫ —Å–æ–≤–µ—Ä—à–µ–Ω—Å—Ç–≤—É",
        image: "img/lexus.png",
        alt: "–°—Ç—Ä–µ–º–ª–µ–Ω–∏–µ –∫ —Å–æ–≤–µ—Ä—à–µ–Ω—Å—Ç–≤—É"
      },
      {
        text: "–õ—É—á—à–µ–µ –∏–ª–∏ –Ω–∏—á–µ–≥–æ",
        image: "img/mercedes.png",
        alt: "–õ—É—á—à–µ–µ –∏–ª–∏ –Ω–∏—á–µ–≥–æ"
      },
      {
        text: "mts",
        image: "img/mts.png",
        alt: "mts"
      },
      {
        text: "–í–µ–¥—å –í—ã —ç—Ç–æ–≥–æ –¥–æ—Å—Ç–æ–π–Ω—ã",
        image: "img/loreal.png",
        alt: "–í–µ–¥—å –í—ã —ç—Ç–æ–≥–æ –¥–æ—Å—Ç–æ–π–Ω—ã"
      },
      {
        text: "nalog",
        image: "img/nalog.png",
        alt: "nalog"
      },
      {
        text: "nike",
        image: "img/nike.png",
        alt: "nike"
      },
      {
        text: "ort",
        image: "img/ort.png",
        alt: "ort"
      },
      {
        text: "twix",
        image: "img/twix.png",
        alt: "twix"
      },
      {
        text: "yandex",
        image: "img/yandex.png",
        alt: "yandex"
      },
      {
        text: "–£–ø—Ä–∞–≤–ª—è–π –º–µ—á—Ç–æ–π ",
        image: "img/toyota.png",
        alt: "–£–ø—Ä–∞–≤–ª—è–π –º–µ—á—Ç–æ–π"
      },
      {
        text: "–¢—ã –º–µ–Ω—è —É–¥–∏–≤–ª—è–µ—à—å",
        image: "img/volga.png",
        alt: "–¢—ã –º–µ–Ω—è —É–¥–∏–≤–ª—è–µ—à—å"
      },
      {
        text: "–ò —Ç—ã –ø–æ–±–µ–¥–∏—Ç–µ–ª—å",
        image: "img/wagon.png",
        alt: "–ò —Ç—ã –ø–æ–±–µ–¥–∏—Ç–µ–ª—å"
      }
    ];

  </script>

  <script>
    // –≠–ª–µ–º–µ–Ω—Ç—ã DOM
    const phrasesList = document.getElementById('phrasesList');
    const spinButton = document.getElementById('spinButton');
    const stopButton = document.getElementById('stopButton');
    const clouds = document.querySelectorAll('.cloud');
    const foxsContainer = document.getElementById('foxsContainer');
    const logo = document.querySelector('.logo');
    const phrasesContainer = document.querySelector('.phrases-container');

    // –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è
    let isSpinning = false;
    let isAutoScrolling = false;
    let animationId = null;
    let autoScrollId = null;
    let startTime = 0;
    let currentPosition = 0;
    let selectedPhraseIndex = -1;
    let phraseHeight = 0;
    let containerHeight = 0;
    let targetPosition = 0;
    let usedPhrasesHistory = [];
    let currentPhrasesOrder = [...PHRASES];
    let spinDuration = 2500;
    const MAX_HISTORY_SIZE = 5;

    // –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã
    const SCALE_ANIMATION_DELAY = 500;
    const AUTO_SCROLL_INTERVAL = 2000;
    const MIN_SPIN_TIME = 2000;
    const MAX_SPIN_TIME = 3000;
    const INITIAL_SPEED = 30;
    const FINAL_SPEED = 8;
    const SLOWDOWN_DURATION = 1500;

    // ========== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ==========
    function init() {
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –ª–∏ —É–∂–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
      if (window.appInitialized) {
        console.log('üîÑ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —É–∂–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –ø—Ä–µ–ª–æ–∞–¥–µ—Ä–æ–º, –∑–∞–ø—É—Å–∫–∞–µ–º —Ç–æ–ª—å–∫–æ –∞–≤—Ç–æ–ø—Ä–æ–∫—Ä—É—Ç–∫—É');

        // –ó–∞–ø—É—Å–∫–∞–µ–º –∞–≤—Ç–æ–ø—Ä–æ–∫—Ä—É—Ç–∫—É —á–µ—Ä–µ–∑ 4 —Å–µ–∫—É–Ω–¥
        setTimeout(() => {
          removeActiveClass();
          startAutoScroll();
        }, 4000);
        return;
      }

      console.log('üîÑ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å –Ω—É–ª—è...');

      // 1. –ü–µ—Ä–µ–º–µ—à–∏–≤–∞–µ–º —Ñ—Ä–∞–∑—ã –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏
      shufflePhrasesOnInit();

      // 2. –†–µ–Ω–¥–µ—Ä–∏–º —Ñ—Ä–∞–∑—ã
      renderPhrases();

      setupEventListeners();
      setupInitialState();
      startCloudsAnimation();

      // 3. –ó–∞–ø—É—Å–∫–∞–µ–º –∞–≤—Ç–æ–ø—Ä–æ–∫—Ä—É—Ç–∫—É —á–µ—Ä–µ–∑ 4 —Å–µ–∫—É–Ω–¥
      setTimeout(() => {
        removeActiveClass();
        startAutoScroll();
      }, 4000);
    }

    function shufflePhrasesOnInit() {
      const newOrder = [...PHRASES];

      // –ù–∞—Ö–æ–¥–∏–º "–ê–≤–∞–Ω–≥–∞—Ä–¥–µ"
      const avangardIndex = newOrder.findIndex(phrase =>
        phrase.image.includes("avangard.png")
      );
      let avangardPhrase = null;

      if (avangardIndex !== -1) {
        avangardPhrase = newOrder.splice(avangardIndex, 1)[0];
      }

      // –¢—â–∞—Ç–µ–ª—å–Ω–æ –ø–µ—Ä–µ–º–µ—à–∏–≤–∞–µ–º –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Ñ—Ä–∞–∑—ã
      for (let i = newOrder.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [newOrder[i], newOrder[j]] = [newOrder[j], newOrder[i]];
      }

      // –í–û–ó–í–†–ê–©–ê–ï–ú "–ê–í–ê–ù–ì–ê–†–î–ï" –í –ù–ê–ß–ê–õ–û —á—Ç–æ–±—ã –æ–Ω–∞ –±—ã–ª–∞ –ø–µ—Ä–≤–æ–π –ø—Ä–∏ –ø–æ–∫–∞–∑–µ
      if (avangardPhrase) {
        newOrder.unshift(avangardPhrase);
      }

      currentPhrasesOrder = newOrder;
      console.log('üîÑ –§—Ä–∞–∑—ã –ø–µ—Ä–µ–º–µ—à–∞–Ω—ã. –ü–µ—Ä–≤–∞—è —Ñ—Ä–∞–∑–∞:', currentPhrasesOrder[0]?.text);
    }

    function setupInitialState() {
      // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º "–ê–≤–∞–Ω–≥–∞—Ä–¥–µ" –ø–æ —Ü–µ–Ω—Ç—Ä—É –∏ –¥–µ–ª–∞–µ–º –∞–∫—Ç–∏–≤–Ω–æ–π
      const centerOffset = containerHeight / 2 - phraseHeight / 2;
      const avangardIndex = currentPhrasesOrder.findIndex(phrase =>
        phrase.image.includes("avangard.png")
      );

      if (avangardIndex !== -1) {
        // –ü–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä—É–µ–º "–ê–≤–∞–Ω–≥–∞—Ä–¥–µ" –ø–æ —Ü–µ–Ω—Ç—Ä—É
        targetPosition = (avangardIndex + 3) * phraseHeight - centerOffset;
        currentPosition = targetPosition;
        phrasesList.style.transform = `translateY(-${currentPosition}px)`;

        // –î–µ–ª–∞–µ–º –∞–∫—Ç–∏–≤–Ω–æ–π
        setTimeout(() => {
          const targetPhraseIndex = Math.floor((targetPosition + centerOffset) / phraseHeight);
          highlightSpecificPhrase(targetPhraseIndex);
        }, 100);
      }

      updateFadeEffects();
    }

    // ========== –£–ü–†–ê–í–õ–ï–ù–ò–ï –ü–û–í–¢–û–†–ê–ú–ò ==========

    function avoidRepeatPhrase() {
      if (usedPhrasesHistory.length === 0) return false;

      const centerOffset = containerHeight / 2 - phraseHeight / 2;
      const currentCenterIndex = Math.floor((currentPosition + centerOffset) / phraseHeight);
      const currentPhraseIndex = (currentCenterIndex - 3) % currentPhrasesOrder.length;

      // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3 —Ñ—Ä–∞–∑—ã
      const lastUsedPhrases = usedPhrasesHistory.slice(0, 3);

      if (lastUsedPhrases.includes(currentPhraseIndex)) {
        // –ù–∞—Ö–æ–¥–∏–º –≤—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Ñ—Ä–∞–∑—ã (–∫—Ä–æ–º–µ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 3 –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã—Ö)
        const availablePhrases = currentPhrasesOrder
          .map((_, index) => index)
          .filter(index => !lastUsedPhrases.includes(index));

        if (availablePhrases.length > 0) {
          // –í—ã–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω—É—é –∏–∑ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö
          const randomIndex = Math.floor(Math.random() * availablePhrases.length);
          const newPhraseIndex = availablePhrases[randomIndex];

          // –°–¥–≤–∏–≥–∞–µ–º –∫ –Ω–æ–≤–æ–π —Ñ—Ä–∞–∑–µ
          targetPosition = (newPhraseIndex + 3) * phraseHeight - centerOffset;
          currentPosition = targetPosition;
          phrasesList.style.transform = `translateY(-${currentPosition}px)`;
          selectedPhraseIndex = newPhraseIndex;

          return true;
        }
      }

      selectedPhraseIndex = currentPhraseIndex;
      return false;
    }

    function ensureAvangardVisible() {
      const avangardIndex = currentPhrasesOrder.findIndex(phrase =>
        phrase.image.includes("avangard.png")
      );

      if (avangardIndex !== -1) {
        const centerOffset = containerHeight / 2 - phraseHeight / 2;
        const currentCenterIndex = Math.floor((currentPosition + centerOffset) / phraseHeight);
        const currentPhraseIndex = (currentCenterIndex - 3) % currentPhrasesOrder.length;

        // –ï—Å–ª–∏ "–ê–≤–∞–Ω–≥–∞—Ä–¥–µ" —Å–µ–π—á–∞—Å –≤ —Ü–µ–Ω—Ç—Ä–µ, —Å–¥–≤–∏–≥–∞–µ–º—Å—è
        if (currentPhraseIndex === avangardIndex) {
          const nextPhraseIndex = (avangardIndex + 1) % currentPhrasesOrder.length;
          targetPosition = (nextPhraseIndex + 3) * phraseHeight - centerOffset;
          currentPosition = targetPosition;
          phrasesList.style.transform = `translateY(-${currentPosition}px)`;
          selectedPhraseIndex = nextPhraseIndex;
          return true;
        }
      }

      return false;
    }

    // ========== –û–°–ù–û–í–ù–´–ï –§–£–ù–ö–¶–ò–ò ==========

    function startSpinning() {
      if (isSpinning) return;

      // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∞–≤—Ç–æ–ø—Ä–æ–∫—Ä—É—Ç–∫—É (–µ—Å–ª–∏ –æ–Ω–∞ –µ—â–µ —Ä–∞–±–æ—Ç–∞–µ—Ç)
      stopAutoScroll();
      isSpinning = true;

      spinButton.disabled = true;
      addSpinButtonAnimation();
      stopButton.disabled = false;

      moveFoxDown();
      moveLogoUp();
      stopCloudsAnimation();
      removeActiveClass();
      removeCenterHighlight();
      addSpinningScale();

      currentPosition = 3 * phraseHeight;

      setTimeout(() => {
        startTime = Date.now();
        spinDuration = MIN_SPIN_TIME + Math.random() * (MAX_SPIN_TIME - MIN_SPIN_TIME);
        animateSpinning();
      }, SCALE_ANIMATION_DELAY);
    }

    function animateSpinning() {
      if (!isSpinning) return;

      const elapsed = Date.now() - startTime;
      const totalHeight = phrasesList.offsetHeight;

      let currentSpeed;

      if (elapsed < spinDuration) {
        currentSpeed = INITIAL_SPEED;
      } else if (elapsed < spinDuration + SLOWDOWN_DURATION) {
        const slowdownProgress = (elapsed - spinDuration) / SLOWDOWN_DURATION;
        currentSpeed = INITIAL_SPEED - (INITIAL_SPEED - FINAL_SPEED) * slowdownProgress;
      } else {
        const finalSlowdownProgress = (elapsed - spinDuration - SLOWDOWN_DURATION) / 1000;

        if (finalSlowdownProgress >= 1) {
          stopSpinning();
          return;
        }

        currentSpeed = FINAL_SPEED * (1 - finalSlowdownProgress);
      }

      currentPosition += currentSpeed;

      if (currentPosition >= totalHeight - containerHeight) {
        currentPosition = currentPosition - (totalHeight - containerHeight) + (3 * phraseHeight);
      }

      phrasesList.style.transform = `translateY(-${currentPosition}px)`;
      updateFadeEffects();

      animationId = requestAnimationFrame(animateSpinning);
    }

    function stopSpinning() {
      if (!isSpinning) return;
      stopButton.disabled = true;
      finishSpinning();
    }

    function finishSpinning() {
      isSpinning = false;

      const centerOffset = containerHeight / 2 - phraseHeight / 2;
      const centerPhraseIndex = Math.floor((currentPosition + centerOffset) / phraseHeight);

      selectedPhraseIndex = (centerPhraseIndex - 3) % currentPhrasesOrder.length;
      if (selectedPhraseIndex < 0) selectedPhraseIndex += currentPhrasesOrder.length;

      // 1. –ü—Ä–æ–≤–µ—Ä—è–µ–º –∏ –∏–∑–±–µ–≥–∞–µ–º –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Ñ—Ä–∞–∑
      const hadRepeat = avoidRepeatPhrase();

      // 2. –ï—Å–ª–∏ –Ω–µ –±—ã–ª–æ –ø–æ–≤—Ç–æ—Ä–∞, –Ω–æ "–ê–≤–∞–Ω–≥–∞—Ä–¥–µ" –≤ —Ü–µ–Ω—Ç—Ä–µ - —Å–¥–≤–∏–≥–∞–µ–º
      if (!hadRepeat) {
        ensureAvangardVisible();
      }

      // 3. –í—ã—á–∏—Å–ª—è–µ–º —Ñ–∏–Ω–∞–ª—å–Ω—É—é –ø–æ–∑–∏—Ü–∏—é
      targetPosition = (selectedPhraseIndex + 3) * phraseHeight - centerOffset;

      // 4. –ü–ª–∞–≤–Ω–∞—è –∞–Ω–∏–º–∞—Ü–∏—è –∫ –∫–æ–Ω–µ—á–Ω–æ–π –ø–æ–∑–∏—Ü–∏–∏
      animateToFinalPosition();
    }

    function animateToFinalPosition() {
      const startPosition = currentPosition;
      const distance = targetPosition - startPosition;
      const animationDuration = 800;

      let animationStartTime = Date.now();

      function animate() {
        const elapsed = Date.now() - animationStartTime;
        const progress = Math.min(elapsed / animationDuration, 1);

        // –ü–ª–∞–≤–Ω–∞—è easing —Ñ—É–Ω–∫—Ü–∏—è
        const easeOut = 1 - Math.pow(1 - progress, 3);

        currentPosition = startPosition + distance * easeOut;
        phrasesList.style.transform = `translateY(-${currentPosition}px)`;
        updateFadeEffects();

        if (progress < 1) {
          animationId = requestAnimationFrame(animate);
        } else {
          // –ö–æ–≥–¥–∞ –∞–Ω–∏–º–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∞–∫—Ç–∏–≤–Ω—É—é —Ñ—Ä–∞–∑—É
          completeSpinning();
        }
      }

      animate();
    }

    function completeSpinning() {
      // –£–±–µ–∂–¥–∞–µ–º—Å—è, —á—Ç–æ –º—ã –Ω–∞ —Ç–æ—á–Ω–æ–π –ø–æ–∑–∏—Ü–∏–∏
      currentPosition = targetPosition;
      phrasesList.style.transform = `translateY(-${currentPosition}px)`;
      updateFadeEffects();

      if (selectedPhraseIndex >= 0) {
        addToHistory(selectedPhraseIndex);
      }

      // –ü–ª–∞–≤–Ω–æ —É–±–∏—Ä–∞–µ–º –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∞–∫—Ç–∏–≤–Ω—É—é —Ñ—Ä–∞–∑—É
      removeSpinningScale();

      setTimeout(() => {
        highlightSelectedPhrase();
        resetUIState();
      }, 300);
    }

    // ========== –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò ==========

    function resetUIState() {
      spinButton.disabled = false;
      removeSpinButtonAnimation();
      stopButton.disabled = true;
      moveFoxUp();
      moveLogoDown();
      startCloudsAnimation();
    }

    function highlightSelectedPhrase() {
      const centerOffset = containerHeight / 2 - phraseHeight / 2;
      const targetPhraseIndex = Math.floor((targetPosition + centerOffset) / phraseHeight);
      highlightSpecificPhrase(targetPhraseIndex);
    }

    function highlightSpecificPhrase(phraseIndex) {
      const phrases = document.querySelectorAll('.phrase');
      phrases.forEach((phrase, index) => {
        if (index === phraseIndex) {
          // –ü–ª–∞–≤–Ω–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ active –∫–ª–∞—Å—Å–∞
          setTimeout(() => {
            phrase.classList.add('active');
          }, 100);
        } else {
          phrase.classList.remove('active');
        }
      });
    }

    function removeActiveClass() {
      const phrases = document.querySelectorAll('.phrase');
      phrases.forEach(phrase => {
        phrase.classList.remove('active');
      });
    }

    // ========== –ê–í–¢–û–ü–†–û–ö–†–£–¢–ö–ê ==========

    function startAutoScroll() {
      // –ê–≤—Ç–æ–ø—Ä–æ–∫—Ä—É—Ç–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
      if (isAutoScrolling || isSpinning) return;

      isAutoScrolling = true;

      console.log('üé¨ –ù–∞—á–∏–Ω–∞–µ–º –∞–≤—Ç–æ–ø—Ä–æ–∫—Ä—É—Ç–∫—É...');

      // –ù–ê–ß–ò–ù–ê–ï–ú –° –¢–ï–ö–£–©–ï–ô –ü–û–ó–ò–¶–ò–ò (–≥–¥–µ —Å–µ–π—á–∞—Å "–ê–≤–∞–Ω–≥–∞—Ä–¥–µ")
      let currentPhraseIndex = Math.floor((currentPosition + (containerHeight / 2 - phraseHeight / 2)) / phraseHeight) - 3;
      if (currentPhraseIndex < 0) currentPhraseIndex += currentPhrasesOrder.length;

      console.log('üìç –ù–∞—á–∏–Ω–∞–µ–º —Å —Ñ—Ä–∞–∑—ã:', currentPhraseIndex, currentPhrasesOrder[currentPhraseIndex]?.text);

      function autoScroll() {
        if (!isAutoScrolling || isSpinning) {
          stopAutoScroll();
          return;
        }

        // –ü–ï–†–ï–•–û–î–ò–ú –ö –°–õ–ï–î–£–Æ–©–ï–ô –§–†–ê–ó–ï
        currentPhraseIndex = (currentPhraseIndex + 1) % currentPhrasesOrder.length;
        const newPosition = (currentPhraseIndex + 3) * phraseHeight;

        phrasesList.style.transition = 'transform 2s ease-in-out';
        phrasesList.style.transform = `translateY(-${newPosition}px)`;
        currentPosition = newPosition;

        // –ê–ö–¢–ò–í–ù–û–°–¢–¨ –° "–ê–í–ê–ù–ì–ê–†–î–ï" –°–ù–ò–ú–ï–¢–°–Ø –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ò –ü–†–ò –ü–ï–†–ï–•–û–î–ï
        setTimeout(() => {
          updateFadeEffects();
          updateCenterHighlight();
        }, 500);

        autoScrollId = setTimeout(autoScroll, AUTO_SCROLL_INTERVAL);
      }

      // –ó–ê–ü–£–°–ö–ê–ï–ú –°–†–ê–ó–£ –ë–ï–ó –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–û–ô –ó–ê–î–ï–†–ñ–ö–ò
      updateFadeEffects();
      updateCenterHighlight();
      autoScroll();
    }

    function stopAutoScroll() {
      isAutoScrolling = false;
      if (autoScrollId) {
        clearTimeout(autoScrollId);
      }
      removeCenterHighlight();
      phrasesList.style.transition = 'none';
      updateFadeEffects();
    }

    // ========== –û–°–¢–ê–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò ==========

    function setupEventListeners() {
      spinButton.addEventListener('click', startSpinning);
      stopButton.addEventListener('click', stopSpinning);

      spinButton.addEventListener('touchstart', function (e) {
        e.preventDefault();
        startSpinning();
      });

      stopButton.addEventListener('touchstart', function (e) {
        e.preventDefault();
        stopSpinning();
      });
    }

    function renderPhrases() {
      phrasesList.innerHTML = '';

      // –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø–µ—Ä–µ–º–µ—à–∞–Ω–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ currentPhrasesOrder
      for (let i = 0; i < 3; i++) {
        const phraseIndex = (currentPhrasesOrder.length - 3 + i) % currentPhrasesOrder.length;
        const phraseElement = createPhraseElementFromOrder(phraseIndex);
        phrasesList.appendChild(phraseElement);
      }

      currentPhrasesOrder.forEach((phrase, index) => {
        const phraseElement = createPhraseElementFromOrder(index);
        phrasesList.appendChild(phraseElement);
      });

      for (let i = 0; i < 3; i++) {
        const phraseIndex = i % currentPhrasesOrder.length;
        const phraseElement = createPhraseElementFromOrder(phraseIndex);
        phrasesList.appendChild(phraseElement);
      }

      phraseHeight = document.querySelector('.phrase').offsetHeight;
      containerHeight = document.querySelector('.phrases-container').offsetHeight;
      currentPosition = 3 * phraseHeight;
      phrasesList.style.transform = `translateY(-${currentPosition}px)`;
    }

    function createPhraseElementFromOrder(index) {
      const phraseElement = document.createElement('div');
      phraseElement.className = 'phrase';

      const img = document.createElement('img');
      img.src = currentPhrasesOrder[index].image;
      img.alt = currentPhrasesOrder[index].alt;
      img.className = 'phrase-image';

      phraseElement.appendChild(img);
      return phraseElement;
    }

    function updatePhrasesDisplay() {
      const phrases = document.querySelectorAll('.phrase');
      phrases.forEach((phraseElement, index) => {
        const img = phraseElement.querySelector('.phrase-image');
        if (img && currentPhrasesOrder[index]) {
          img.src = currentPhrasesOrder[index].image;
          img.alt = currentPhrasesOrder[index].alt;
        }
      });
    }

    // –§—É–Ω–∫—Ü–∏–∏ –∞–Ω–∏–º–∞—Ü–∏–∏
    function stopCloudsAnimation() {
      clouds.forEach(cloud => {
        cloud.style.animationPlayState = 'paused';
      });
    }

    function startCloudsAnimation() {
      clouds.forEach(cloud => {
        cloud.style.animationPlayState = 'running';
      });
    }

    function moveFoxDown() {
      foxsContainer.classList.add('fox-down');
    }

    function moveFoxUp() {
      foxsContainer.classList.remove('fox-down');
    }

    function moveLogoUp() {
      logo.classList.add('up');
    }

    function moveLogoDown() {
      logo.classList.remove('up');
    }

    function addSpinningScale() {
      phrasesContainer.style.transition = 'transform 0.3s ease-out';
      phrasesContainer.classList.add('spinning');
    }

    function removeSpinningScale() {
      // –ü–ª–∞–≤–Ω–æ–µ —É–±–∏—Ä–∞–Ω–∏–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è
      phrasesContainer.style.transition = 'transform 0.5s ease-out';
      phrasesContainer.classList.remove('spinning');

      // –£–±–∏—Ä–∞–µ–º transition –ø–æ—Å–ª–µ –∞–Ω–∏–º–∞—Ü–∏–∏
      setTimeout(() => {
        phrasesContainer.style.transition = '';
      }, 500);
    }

    function addSpinButtonAnimation() {
      spinButton.classList.add('spinning');
    }

    function removeSpinButtonAnimation() {
      spinButton.classList.remove('spinning');
    }

    function updateCenterHighlight() {
      const phrases = document.querySelectorAll('.phrase');
      const centerOffset = containerHeight / 2 - phraseHeight / 2;
      const centerPhraseIndex = Math.round((currentPosition + centerOffset) / phraseHeight);

      phrases.forEach((phrase, index) => {
        phrase.classList.remove('center-highlight');
        if (index === centerPhraseIndex) {
          phrase.classList.add('center-highlight');
        }
      });
    }

    function removeCenterHighlight() {
      const phrases = document.querySelectorAll('.phrase');
      phrases.forEach(phrase => {
        phrase.classList.remove('center-highlight');
      });
    }

    function updateFadeEffects() {
      const phrases = document.querySelectorAll('.phrase');
      const centerOffset = containerHeight / 2 - phraseHeight / 2;
      const centerPhraseIndex = Math.floor((currentPosition + centerOffset) / phraseHeight);

      phrases.forEach((phrase, index) => {
        phrase.classList.remove('top-fade', 'bottom-fade');

        if (index === centerPhraseIndex - 1) {
          phrase.classList.add('top-fade');
        } else if (index === centerPhraseIndex + 1) {
          phrase.classList.add('bottom-fade');
        }
      });
    }

    function addToHistory(phraseIndex) {
      // –î–æ–±–∞–≤–ª—è–µ–º –≤ –Ω–∞—á–∞–ª–æ –∏—Å—Ç–æ—Ä–∏–∏
      usedPhrasesHistory.unshift(phraseIndex);

      // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä –∏—Å—Ç–æ—Ä–∏–∏
      if (usedPhrasesHistory.length > MAX_HISTORY_SIZE) {
        usedPhrasesHistory = usedPhrasesHistory.slice(0, MAX_HISTORY_SIZE);
      }
    }

    function lockOrientation() {
      if (screen.orientation && screen.orientation.lock) {
        screen.orientation.lock('portrait').catch(function (error) {
          console.log('Orientation lock failed: ', error);
        });
      }
    }

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
    window.addEventListener('DOMContentLoaded', function () {
      init();
      lockOrientation();
    });

    window.addEventListener('orientationchange', function () {
      setTimeout(lockOrientation, 100);
    });
  </script>



</body>

</html>